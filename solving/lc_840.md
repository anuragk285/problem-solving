# Magic Squares in grid

```java
class Solution {
    int[][] grid;
    public int numMagicSquaresInside(int[][] grid) {
        this.grid = grid;
        int ans = 0;
        for(int i=0; i<grid.length-2; i++){
            for(int j=0; j<grid[0].length-2; j++){
                ans += (isMagicSquare(i, j)) ? 1 : 0;
            }
        }
        return ans;
    }
    private boolean isMagicSquare(int row, int col){
        int sum = 0, totalSum = 0;
        boolean[] visited = new boolean[9];
        for(int i=row; i<row+3; i++){
            for(int j=col; j<col+3; j++){
                if(grid[i][j] == 0 || grid[i][j] > 9) return false;
                if(visited[grid[i][j]-1]) return false;
                visited[grid[i][j]-1] = true;
                totalSum += grid[i][j];
            }
        }
        for(int i=0; i<9; i++) if(!visited[i]) return false;
        if(totalSum != 45) return false;
        for(int j=col; j<col+3; j++) sum += grid[row][j];

        for(int i=row+1; i<row+3; i++){
            int rSum = 0;
            for(int j=col; j<col+3; j++) rSum += grid[i][j];
            if(rSum != sum) return false;
        }
        for(int j=col; j<col+3; j++){
            int cSum = 0;
            for(int i=row; i<row+3; i++) cSum += grid[i][j];
            if(cSum != sum) return false;
        }
        int diag1 = 0, diag2 = 0;
        diag1 = grid[row][col] + grid[row+1][col+1] + grid[row+2][col+2];
        diag2 = grid[row][col+2] + grid[row+1][col+1] + grid[row+2][col];
        if(diag1 != sum || diag2 != sum) return false;
        return true;
    }
}
```
