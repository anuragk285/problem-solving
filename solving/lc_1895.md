# Largest magic Square

```java
class Solution {
    int minSideLength = -1;
    int rows =0, cols =0;
    int[][] grid;
    public int largestMagicSquare(int[][] grid) {
        this.grid = grid;
        rows = grid.length;
        cols = grid[0].length;
        minSideLength = Math.min(rows, cols);
        int ans = 0;
        for(int i=0; i<rows; i++){
            for(int j=0; j<cols; j++){
                ans = Math.max(ans, magicSquareSide(i, j));
            }
        }
        return ans;
    }
    private int magicSquareSide(int r, int c){
        int maxSide = 0;
        for(int k=1; k<=minSideLength; k++){
            if(r+k > rows || c+k > cols) return maxSide;
            if(isMagicSquare(r, c, k)) maxSide = k;
        }
        return maxSide;
    }
    private boolean isMagicSquare(int r, int c, int k){
        int target = 0;

        // row sum
        int sum =0;
        for(int i=r; i<r+k; i++){
            sum =0;
            for(int j=c; j<c+k; j++) sum += grid[i][j];
            if(i == r) target = sum;
            else if(sum != target) return false;
        }

        // col sum
        for(int j=c; j<c+k; j++){
            sum = 0;
            for(int i=r; i<r+k; i++) sum += grid[i][j];
            if(sum != target) return false;
        }

        // diag1 sum (left to right)
        int diag1Sum = 0;
        for(int d=0; d<k; d++){
            if(!isValid(r+d, c+d)) break;
            diag1Sum += grid[r+d][c+d];
        }
        if(diag1Sum != target) return false;

        // diag2 sum (right to left)
        int diag2Sum = 0;
        for(int d=0; d<k; d++){
            if(!isValid(r+d, c+d)) break;
            diag2Sum += grid[r+d][c+(k-1)-d];
        }
        if(diag2Sum != target) return false;

        return true;
    }
    private boolean isValid(int r, int c){
        if(r < 0 || r >= rows || c < 0 || c >= cols) return false;
        return true;
    }
}
```
