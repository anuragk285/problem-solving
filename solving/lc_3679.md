# Minimum discards to balance inventory

```python
from collections import deque
class Solution(object):
    def minArrivalsToDiscard(self, arrivals, w, m):
        """
        :type arrivals: List[int]
        :type w: int
        :type m: int
        :rtype: int
        """
        discards = 0
        window = {}
        deleted_days = deque()
        # First window
        for i in range(w):
            window[arrivals[i]] = window.get(arrivals[i], 0) + 1
            if window[arrivals[i]] > m:
                discards += 1
                window[arrivals[i]] -= 1
                deleted_days.append(i)
                if window[arrivals[i]] == 0:
                    del window[arrivals[i]]
        print(discards)
        # Slide the window
        for i in range(w, len(arrivals)):
                
            old = arrivals[i - w]
            if deleted_days and i-w == deleted_days[0]:
                deleted_days.popleft()
            elif window.get(old, 0) > 0:
                window[old] -= 1
                if window[old] == 0:
                    del window[old]
            # Add new item
            window[arrivals[i]] = window.get(arrivals[i], 0) + 1
            if window[arrivals[i]] > m:
                discards += 1
                window[arrivals[i]] -= 1
                deleted_days.append(i)
        return discards
```
