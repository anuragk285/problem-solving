# Count Mentions per User

```java
class Solution {
    static class Pair{
        int timeGetsOnline, id;
        Pair(int id, int timeGetsOnline){
            this.id = id;
            this.timeGetsOnline = timeGetsOnline;
        }
    }
    Queue<Pair> offlineUsers = new LinkedList<>();
    boolean[] status;
    int[] mentions;
    public int[] countMentions(int numberOfUsers, List<List<String>> events) {
        events.sort((a, b) -> {
            int timeA = Integer.parseInt(a.get(1));
            int timeB = Integer.parseInt(b.get(1));
            if(timeA != timeB) return Integer.compare(timeA, timeB);
            boolean aMessage = a.get(0).equals("MESSAGE");
            boolean bMessage = b.get(0).equals("MESSAGE");
            return Boolean.compare(aMessage, bMessage);
        });
        status = new boolean[numberOfUsers];
        Arrays.fill(status, true);
        mentions = new int[numberOfUsers];
        for(int i=0; i<events.size(); i++){
            if(events.get(i).get(0).equals("MESSAGE")){
                //MESSAGE EVENT 
                int timestamp = Integer.parseInt(events.get(i).get(1));
                updateUsers(timestamp);
                String mentionString = events.get(i).get(2);
                if(mentionString.equals("ALL")){
                    for(int j=0; j<numberOfUsers; j++) mentions[j]++;
                }else if(mentionString.equals("HERE")){
                    for(int j=0; j<numberOfUsers; j++) if(status[j]) mentions[j]++;
                }else{
                    String[] ids = mentionString.split(" ");
                    for(String idString : ids){
                        int id = Integer.parseInt(idString.substring(2));
                        mentions[id]++;
                    }
                }
            }else{
                //OFFLINE EVENT
                int timestamp = Integer.parseInt(events.get(i).get(1));
                updateUsers(timestamp); 
                int id = Integer.parseInt(events.get(i).get(2));
                //System.out.println(id+" Goes Offline at "+timestamp);
                status[id] = false;
                offlineUsers.add(new Pair(id, timestamp+60));
            }
        }
        return mentions;
    }
    public void updateUsers(int timestamp){
        while(!offlineUsers.isEmpty() && offlineUsers.peek().timeGetsOnline <= timestamp){
            Pair user = offlineUsers.poll();
            status[user.id] = true;
            //System.out.println(user.id+" comes online at "+timestamp);
        }
    }
}
```
