# Water Bottles II

```python
class Solution(object):
    def maxBottlesDrunk(self, numBottles, numExchange):
        """
        :type numBottles: int
        :type numExchange: int
        :rtype: int
        """
        fullBottles = numBottles
        bottlesDrunk = 0
        emptyBottles = 0

        while emptyBottles >= numExchange or fullBottles > 0:
            # drinking
            if fullBottles > 0:
                emptyBottles += fullBottles
                bottlesDrunk += fullBottles
                fullBottles = 0

            # exchanging
            if emptyBottles >= numExchange:
                fullBottles = 1
                emptyBottles = emptyBottles-numExchange
                numExchange += 1

        return bottlesDrunk
```
