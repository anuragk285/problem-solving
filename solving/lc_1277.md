# count square sub matrices with all ones

```python
class Solution(object):
    def countSquares(self, mat):
        """
        :type matrix: List[List[int]]
        :rtype: int
        """
        dp = [[0]*(len(mat[0])+1) for _ in range(len(mat)+1)]

        res = 0
        for i in range(len(mat)):
            for j in range(len(mat[0])):
                if mat[i][j] == 0 : dp[i+1][j+1] = 0
                else : dp[i+1][j+1] = min(dp[i+1][j], dp[i][j+1], dp[i][j])+mat[i][j]

        for i in range(len(dp)):
            res += sum(dp[i])
        
        return res
        
```

